use std::{
    collections::{HashMap, VecDeque},
    fmt::Display,
};

use itertools::Itertools;

#[derive(Debug, Clone, PartialEq, Eq, PartialOrd, Ord, Hash)]
enum SpringCondition {
    Operational,
    Damaged,
    Unknown,
}

impl Display for SpringCondition {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        write!(
            f,
            "{}",
            match self {
                SpringCondition::Operational => ".",
                SpringCondition::Damaged => "#",
                SpringCondition::Unknown => "?",
            }
        )
    }
}

#[derive(Debug, Clone, PartialEq, Eq, PartialOrd, Ord, Hash)]
struct ConditionRecord {
    springs: Vec<SpringCondition>,
    damaged_spring_groups: Vec<usize>,
}

impl Display for ConditionRecord {
    fn fmt(&self, f: &mut std::fmt::Formatter<'_>) -> std::fmt::Result {
        write!(
            f,
            "{} {}",
            self.springs
                .iter()
                .map(|condition| match condition {
                    SpringCondition::Operational => '.',
                    SpringCondition::Damaged => '#',
                    SpringCondition::Unknown => '?',
                })
                .fold("".to_owned(), |acc, cur| acc + &cur.to_string()),
            self.damaged_spring_groups.iter().join(",")
        )
    }
}

#[derive(Debug, Clone, Copy)]
struct GroupPointer {
    start: usize,
    len: usize,
}

impl ConditionRecord {
    fn count_possible_arrangements(&self) -> usize {
        // 1. Set up groups;
        let initial_arrangement: (Vec<SpringCondition>, Vec<GroupPointer>) = {
            // We turn something like ".#...#....###." into ".......#.#.###", in preparation
            // for the permutations finder.
            let mut arrangement = self
                .damaged_spring_groups
                .iter()
                .flat_map(|len| {
                    let mut damaged: Vec<SpringCondition> =
                        (0..*len).map(|_| SpringCondition::Damaged).collect();
                    damaged.push(SpringCondition::Operational);

                    damaged
                })
                .collect::<VecDeque<SpringCondition>>();
            arrangement.pop_back();
            let num_operational_to_insert = self.springs.len() - arrangement.len();
            for _ in 0..num_operational_to_insert {
                arrangement.push_front(SpringCondition::Operational);
            }

            // When we have something like this: ".......#.#.###", we want to know the indices of where
            // the operational groups start:      ^       ^ ^
            // We also want to know their length. 7       1 1
            let indices =
                group_conditions(&arrangement.clone().into(), SpringCondition::Operational);

            (arrangement.into(), indices)
        };

        // 2. Using this information, we can now recursively shrink & enlarge the gaps between groups,
        //    every iteration we use the original spring configuration as a mask and check if it's
        //    valid. We count the valid configurations.
        recursively_count_potential_arrangements(
            self,
            initial_arrangement.0.clone(),
            initial_arrangement.1.clone(),
            0,
        )
    }

    fn does_arrangement_satisfy_constraints(
        &self,
        arrangement: &Vec<SpringCondition>,
        check_until: Option<usize>,
    ) -> bool {
        for i in 0..check_until.unwrap_or(arrangement.len()) {
            if self.springs[i] == SpringCondition::Unknown {
                continue;
            }

            if self.springs[i] != arrangement[i] {
                return false;
            }
        }

        true
    }

    fn expand(&self, times: usize) -> Self {
        let mut springs: Vec<SpringCondition> = vec![];
        let mut damaged_spring_groups = vec![];

        for _ in 0..times - 1 {
            springs.extend(self.springs.clone());
            springs.push(SpringCondition::Unknown);
            damaged_spring_groups.extend(self.damaged_spring_groups.clone());
        }

        springs.extend(self.springs.clone());
        damaged_spring_groups.extend(self.damaged_spring_groups.clone());

        ConditionRecord {
            springs,
            damaged_spring_groups,
        }
    }

    fn efficiently_count_possible_arrangements(
        &self,
        index_in_record: usize,
        current_group_index: usize,
        broken_springs_generated_in_current_group: usize,
        cache: &mut HashMap<usize, usize>,
    ) -> usize {
        // Recursion base case
        if index_in_record == self.springs.len() - 1 {
            if current_group_index != self.damaged_spring_groups.len() - 1 {
                return 0;
            } else if self.springs[index_in_record] == SpringCondition::Operational {
                return 1;
            } else if self.springs[index_in_record] == SpringCondition::Damaged
                && broken_springs_generated_in_current_group - 1
                    == self.damaged_spring_groups[current_group_index]
            {
                return 1;
            }
        }

        match self.springs[index_in_record] {
            SpringCondition::Operational => self.efficiently_count_possible_arrangements(
                index_in_record + 1,
                current_group_index,
                0,
                cache,
            ),
            SpringCondition::Damaged => match broken_springs_generated_in_current_group {
                0 => self.efficiently_count_possible_arrangements(
                    index_in_record + 1,
                    current_group_index + 1,
                    0,
                    cache,
                ),
                // TODO: When we're "done" with a damaged group, check if it aligns with our needs. If
                // it does, add/return 1, if it doesn't, add/return 0.
                other => self.efficiently_count_possible_arrangements(
                    index_in_record + 1,
                    current_group_index,
                    other + 1,
                    cache,
                ),
            },
            SpringCondition::Unknown => {
                // Treat ? as .
                self.efficiently_count_possible_arrangements(
                    index_in_record + 1,
                    current_group_index,
                    0,
                    cache,
                )
                // Treat ? as #
                // TODO: When we're "done" with a damaged group, check if it aligns with our needs. If
                // it does, add/return 1, if it doesn't, add/return 0.
                + match broken_springs_generated_in_current_group {
                    0 => self.efficiently_count_possible_arrangements(
                        index_in_record + 1,
                        current_group_index + 1,
                        0,
                        cache,
                    ),
                    other => self.efficiently_count_possible_arrangements(
                        index_in_record + 1,
                        current_group_index,
                        other + 1,
                        cache,
                    ),
                }
            }
        }
    }
}

fn main() {
    assert_eq!(21, part1(&test_input()));
    assert_eq!(7622, part1(&input()));

    assert_eq!(525_152, part2(&test_input()));
    // assert_eq!(0, part2(&input()));
}

#[allow(dead_code)]
fn part1(input: &String) -> usize {
    parse_records(input)
        .iter()
        .map(|record| record.count_possible_arrangements())
        .sum()
}

#[allow(dead_code)]
fn part2(input: &String) -> usize {
    parse_records(input)
        .iter()
        .map(|record| {
            record
                .expand(5)
                .efficiently_count_possible_arrangements(0, 0, 0, &mut HashMap::new())
        })
        .sum()
}

fn parse_records(input: &str) -> Vec<ConditionRecord> {
    input
        .lines()
        .map(|line| {
            let mut split = line.split_whitespace();

            ConditionRecord {
                springs: split
                    .next()
                    .unwrap()
                    .chars()
                    .map(|ch| match ch {
                        '.' => SpringCondition::Operational,
                        '#' => SpringCondition::Damaged,
                        '?' => SpringCondition::Unknown,
                        other => panic!("Cannot parse {other} as a valid spring condition"),
                    })
                    .collect(),
                damaged_spring_groups: split
                    .next()
                    .unwrap()
                    .split(",")
                    .map(|num| num.parse().unwrap())
                    .collect(),
            }
        })
        .collect()
}

fn group_conditions(
    conditions: &Vec<SpringCondition>,
    type_to_group: SpringCondition,
) -> Vec<GroupPointer> {
    let mut result = Vec::new();
    let mut current_start: Option<usize> = None;
    let mut current_len = 0;

    for (index, condition) in conditions.iter().enumerate() {
        match condition {
            spring_condition if spring_condition == &type_to_group => {
                if current_start.is_none() {
                    current_start = Some(index);
                }
                current_len += 1;
            }
            _ => {
                if let Some(start) = current_start {
                    result.push(GroupPointer {
                        start,
                        len: current_len,
                    });
                }
                current_start = None;
                current_len = 0;
            }
        }
    }

    if let Some(start) = current_start {
        result.push(GroupPointer {
            start,
            len: current_len,
        });
    }

    if *conditions.last().unwrap() != type_to_group {
        result.push(GroupPointer {
            start: conditions.len(),
            len: 0,
        });
    }

    result
}

fn recursively_count_potential_arrangements(
    record: &ConditionRecord,
    mut arrangement: Vec<SpringCondition>,
    mut idx_pointers: Vec<GroupPointer>,
    index: usize,
) -> usize {
    if index == idx_pointers.len() - 1 {
        return 0;
    }

    let mut count = 0;

    if index == 0 && record.does_arrangement_satisfy_constraints(&arrangement, None) {
        count = 1;
    }

    let max = match (idx_pointers[index].start, index) {
        (0, 0) => idx_pointers[index].len,
        _ => idx_pointers[index].len - 1,
    };

    for _ in 0..max {
        arrangement.insert(idx_pointers[index + 1].start, SpringCondition::Operational);
        arrangement.remove(idx_pointers[index].start);

        idx_pointers[index].len -= 1;
        idx_pointers[index + 1].len += 1;
        idx_pointers[index + 1].start -= 1;

        if record.does_arrangement_satisfy_constraints(&arrangement, None) {
            count += 1;
        }

        // Only go to check recursively if there's even any hope of finding something useful.
        if record
            .does_arrangement_satisfy_constraints(&arrangement, Some(idx_pointers[index].start))
        {
            count += recursively_count_potential_arrangements(
                record,
                arrangement.clone(),
                idx_pointers.clone(),
                index + 1,
            );
        }
    }

    count
}

fn test_input() -> String {
    "???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1"
        .to_string()
}

#[allow(dead_code)]
fn input() -> String {
    "????#?#???.??.. 9,2
?.#?????????###.?# 1,1,2,1,5,1
.???#????#?????#?#? 1,9,4
?#?.??.#?.??? 2,1,1,1
?????????#?###???.?. 1,9
????#?.?.?? 1,2,1
.???????#???..? 1,5
#????????#?#??#??. 2,14
?.?????.?? 2,2
???##??###???????#?? 9,4
.#.?.??..?# 1,1,2
.?????#??? 2,1,2
??.?..?#?##?????# 1,1,11
?.???.??.??#?. 1,2,2,4
...#??..????##??. 1,6
?????#.?##?????.??? 5,2,1,1,1
?##?#?.???#?.?? 5,4,1
.?.##???????#????.? 3,5
.?#???#?#..???.?? 6,1,1,1
.???##.???# 5,2,1
?#?#?#?.?#?.?? 5,3
.?#?.??.?# 1,1,1
?#???#?.???????.#. 2,2,6,1
##???.??.?.?? 4,1
.???#??.?#.. 4,2
??#??..#?..## 5,1,2
??##??#?????.??? 2,3,1,1
.????.?##????#?? 2,6,2
.?##????.?##???#?. 3,3,4,2
?#??????????#????## 2,1,1,3,2,4
?????.???????????? 4,1,1,6
???##?##????? 6,1
?.?..??#??#???.. 1,7
?#?????##??##????#.? 3,1,7,1,1,1
#???#???##????#??... 1,14
?????##??.?????. 1,6,2,1
???#????????#? 4,8
##???#..??##??#??.#? 3,2,1,6,1
???????????.#?? 4,3,2
?#???#?????? 1,6,1
?.?.??###...???#?.?? 5,5
..??????#???? 1,1
?????????????? 2,4,1,1
?#.?.?#?#?. 1,4
#?.?#????????#???? 2,3,8
?????#?#.????? 6,1,1,1
????#.??..? 4,2,1
?????????#?.? 2,2,3
???#???..?# 3,2,2
.#??.?.?.?##??##?#. 1,1,1,9
??#?#???#???##? 8,5
#??????###??????.??? 1,2,10,3
#?#?#??????#??? 1,1,5,4
#???.???#?????#?? 1,1,1,5,1
#?.?##??.?? 1,3,1
????????##??? 1,1,4
??..??.??##???????. 1,10
??.?????#?#??##???? 1,1,1,4,6
??#.?????#?#?? 1,1,3,5
?????##????# 1,7
??.?.??#????? 1,1,1,2
..?.???.??????? 1,1,1,2,1
????????#?#???#??? 2,1,8
?????#?##????????.?. 2,5,4,1
#?????..?.??##?# 1,1,1,5
.#??.????? 2,1,1
??#??##??.?#?. 8,1
.?????.#?. 4,1
.?#??#.????. 3,1,1,1
????.???..?#??. 1,1,1,4
?##??.??..#?#? 3,2,3
????#??.????.. 1,3,1
?.?##???##?.???.??? 1,8,3,3
??#??.#?#??? 3,3,1
.?????.?#???????? 1,3,6,2
??#??????????????#? 1,1,1,4,4,1
?.?.??#..???#?. 1,1,1,1,3
??#??....###??? 2,3
?????#?.###???.#?. 3,3,3,1
#..???.#???????? 1,1,2,1,2
???#???.#??# 4,1,2
?.??????????. 4,2
.#??..????? 1,5
?#?#?#???..??#??# 5,1,6
???#?????? 4,1
??#??##??.????? 7,2
..#????..#?#?.? 5,3
?..?.??#???#?? 1,1,2,5
#???##.??.?#?#? 2,3,1,5
????????.?#?? 1,3,1,2
#???..?#??? 1,1,3
#?#???.#..????#.#?? 1,4,1,3,1,3
#??#.???.#?#???. 1,1,1,1,6
???##????????#???.#? 9,1,5,1
?.#????#??.?#?.? 1,1,3,1,1
##?????.?.. 2,1,1
?#???#.#?#.??.??. 3,1,3,1,1
.??#???.?.????.#??#? 6,4,4
?.???####??.#???.??? 6,4,1
#.???#???#??? 1,4,1
???#???#?#??? 1,4,5
???#??.####???##?? 1,2,6,2,1
#?#.?????.??# 3,5,2
.#??.??#?? 1,3
??#?##???#??#..???? 12,1
???.??.???????#???# 1,2,12
??????#??.?#?##?? 4,6
.????.????## 4,2,2
.#????????????.##? 1,2,2,3
???.???#???..????#? 1,5,1,1,1,1
???????#?. 3,4
.???###?#????..? 1,9
.#??#????#?.??#?... 6,1,4
#????#??????.?#?? 1,1,8,1,1
?.????.??#.? 3,1
.????.??.??? 1,1,2,1
???????.?.?.??.?? 3,1,1
#????#????#.??? 1,8,1,1
.???????.?#?#??# 2,4,2,4
#??#???.#??.????##? 2,1,1,2,1,5
?#?#?.????????? 4,1,1,3
..?.?####??.?? 1,7,1
??###????#??? 4,5
...?#?????.???.??.. 2,1
.???????.????##.??# 4,1,1,2,2
.???.?.?#?? 1,1,2
#???...#?#??#?. 2,1,7
??###?#????????. 8,1,2
.??.?#?????#??? 1,9
??.?????#?#?????? 1,7
.????.#??? 4,1,2
?#?.?#?.??# 3,2,1
?.?#.???#?# 2,3
????#.????. 4,1
???????????#?????.? 1,1,8,1
.???##???#?? 1,3,1,1
????.????.#??? 1,3,4
????????.#??#..#?## 4,1,2,1,1,2
..??.?.#???##?.??.. 1,6
??.#????????#?## 4,3,4
??#??????#.##?# 5,2,4
???.#???.? 1,1,1
?#?????.?.?? 1,2,1,1
#????.?.#?? 1,1,2
?#??#????#??#?? 1,2,9
?#????#????.????.?? 10,1,1
????.????.?? 2,1,1,1
?#??#???.???.#?##? 7,3,1,2
??.??#???...????.? 5,1
???????.?? 1,2,1
.#.?####.. 1,4
?.#??.??#?##???. 1,2,5
??.?#??????? 3,2
??#?????????.?? 3,1,1,1,1
?????????? 2,1,1
???????????..? 3,2
????##???? 6,1
?#????##?# 3,4
????????.?#? 4,2,1
####..#?..?#?.? 4,2,1
?#?..?#?.?#.??? 2,1,2,1
???????..?#? 3,1,1,1
?#???????. 1,1,1
#.????????#???.? 1,1,1,7
?#?#??#??? 1,4,2
..??.?..?.??. 1,1
..?#???.???..? 4,3
?#?##.?.#? 4,1
.??#?#.?.??.???? 5,1,1,1
?#??#???????. 5,3
#?#?#?#??????. 1,7,1,1
????????.?. 2,2
???.??.????????#. 2,7
?.#..??????#????.? 1,10
??#?##??.???#?? 3,3,5
???????.????#?.. 2,3,5
..???????????? 1,3,1
?..??#??.?#????? 1,1,1,1,5
????#?..?? 5,1
???#.??#??.????? 4,3,3,1
?#?#??.??.?#?? 3,1,1,3
??.???##??#? 1,1,5
?#.?.???.????? 1,1,3,2
#???..??#???#?????? 1,1,1,3,1,3
??????##????.?..# 8,1,1,1
#????##??#? 2,5,1
#??.???#?..? 2,1,3
???.?.????????#.???? 1,1,8,3
??.#.#?.#???##????? 1,1,2,1,6
.??????????.???# 3,3,3
???#?#????? 4,3
?.????????#????.? 1,2,7
???##?#??.???? 6,1
??#???.?.#??##? 2,1,5
??#?.??###? 1,4
??###????.??#? 7,1,2
????.#????##??? 1,2,6
?#???#???# 7,1
??????#??#..?? 10,1
..##????.?? 2,2
.???.????#??.??????? 1,2,2,1,3
????#?#??#??.. 5,2
?#??.?.?..#??? 4,1,2
??#???.#?????# 3,2,4,1
???##??##.??#?..?#.? 1,6,2,1,1
#?#?#???????#???? 6,3
??????.?#?? 2,1,3
???#???#????#?..?? 2,8,1
????#?#???.??.?. 1,7,1,1
?????.?##?.? 3,3
?????.#?????? 5,1,2,1
?#...???#??#?????.?. 1,4,7
???#????#?? 2,2
.#?#???.???# 1,1,1,1
?#??#??.#?.?.?#??? 7,1,1,2,1
??.#.?????? 1,1
#?#?????#?#?? 5,1,1
??#?##????.???????? 1,4,1,1,2,1
?#????.?.#? 1,2,1
##??????#???#??#? 13,2
.???###?.????##? 5,4
????#?.?..???????? 3,2,1,1,1,1
?.?#??????????.? 3,1,3,1,1
.#?????#.#????? 1,1,2,5
???????#.. 1,1,2
??##??#??#?.#??#... 5,1,1,1,2
..#??##???##????##?# 16,1
??????????? 1,3
??#?#?.????####??.? 3,8
?????.???#?..#?## 2,1,4,4
??.???????##?#??#??? 1,1,3,10
????????#????#??.?# 2,10,2
?#?#??????????????#? 11,4
.#?.#???##. 2,6
??#..#??.?..# 3,3,1,1
???????##?.??????.?? 10,1,1,1,1
????#????????????#.? 3,12
???.?#.?#?. 2,1
.#?.???#??? 1,1,5
????#.#???#? 1,2,2,1
.?.?.???#????#? 1,5,2
???.?#???? 1,3
??.??#?#?.??# 1,5,1,1
.#.????#??????? 1,1,2,1,3
#????#??..?..??????. 8,1,3,1
?#???.??###?.????.. 5,6,1,1
???#???.??? 4,1
????#?#????????#?? 10,4
?.?#???#.?.?###?.?. 1,2,1,1,4,1
?##??????????????. 5,3,5,1
.??????????.???.#. 4,1,1,3,1
.?????#..??.??#..? 4,3
...??#?.???.?##??#?. 2,7
?????###?#???#. 2,6,2
????.??#.? 1,1,3
.?.???#??. 1,4
??.????.?????.?#. 1,2,4,2
??.#???#?? 1,7
.????#??#??#?# 1,11
?...#??.?##?#??????? 1,5
###???????????.#.?? 13,1,1
.????##?????????.?#? 9,1,2,2
.#?##?..??????## 4,1,2
?##?#?????.#??.???? 6,2,3,2
?.?#??##.? 1,6
#????.???.???# 2,1,3,4
...????##???.?### 6,4
.?.?##??????#????? 6,3
.??.#???#??#..?#?..? 1,1,5,3,1
???##?##????.#???? 11,1,1
?????#????????? 1,1,2,1,2
#???..?????? 1,2,1,1
.??????#??#??#??. 7,6
.???????.???#?? 3,1,1,1,1
??#??#..????? 4,2
.????#????.??.? 4,1
#??#??.??.##?.#.?? 1,2,1,2,1,2
??????#?#?#??#? 1,1,7,1
?????????..??? 3,3,1
?.#??????##?##??? 1,1,1,6,1
#???.#?????#.????? 1,1,1,1,1,3
#?#.?#????#?##??? 3,12
#.????#..????#?#? 1,1,2,7
?#??#????.#???? 7,2,1
?.#..??#??##?#.#? 1,1,6,1,2
?#??###?#?.?????? 3,5,1,4
.?.#???#??????##.??? 1,5,7,1,1
?..???#.?. 1,1,1
?#???#??###?#.? 5,5
??????????#???#..?? 6,1,2
???#????.???## 5,5
????#??.?? 1,3,1
?????#?#.? 1,1,3
???#??#??????? 1,1,2,4
???..??#.???? 3,2
????????.#??.????.?. 8,1,1,3,1
?????.?.###?#? 3,5
?.?#?#????#??#????? 1,8,4,1
#..??#??.#.??. 1,3,1,1
??.?#?????#?.# 8,1
.??#???.?#.?#???#? 1,1,2,2,6
.?#.?##?.. 1,3
?#????..##??#??? 6,2,5
??#?#??..#??#? 7,4
#?#???#.#??.??????#? 3,1,1,1,1,6
?##.???????#???? 2,11
#?#.#?#?????###?##?. 1,1,14
?#????#.?? 5,1
??????????.??.?? 3,1,2
??????#??????????. 1,1,8,1,2
??.#?##???? 2,4,2
#.?#?##??????.#???? 1,8,1,2,1
??#???????#.#?#?# 5,1,2,3,1
?????????##???#? 2,1,4,1
?#?..?..?????.?? 3,1,1,1,1
.#?????#??..???##??? 4,3,8
?????..?.?? 2,1,1
#?##?.???#.???#? 4,1,1,3
?#?#?#?###..?.#?# 1,7,1,1,1
??#?..?.##??# 2,1,2,2
??.??#????# 2,4,2
??#?????#??#???# 13,1
??.???????#?#? 1,8,2
.???#??#?#????#???#? 1,15
?????..???. 2,2
.?.###???? 1,5,1
?##?.????#????? 3,9
.???????????##?.? 1,10
??.??#??#????.? 1,7,1,1
?#??.???#?#??.#?#? 1,1,5,3
????.###?? 2,5
??#???##??? 2,2
?.???.#?..?. 1,1
?.??##?##??##?#????? 1,12,1,1
???????????#?###? 2,2,3,3
#?.????##?##????.? 1,9
???##?????.##???.?.? 6,1,3,1,1,1
???.###???##??#..#? 1,1,11,1
#?..#???????#?# 1,3,6
??#???#?.???#?. 8,3
#??#.????#?##??#.? 1,1,3,7,1
.?.?.????? 1,1
?.?.?#?.??#? 1,1,1,2
?#????.???????# 1,2,3,4
??????#.???#?.. 1,1,5
???#?#?#??#??#?? 3,1,7
??#????.???????? 4,1,2,1,2
#???#?.??? 2,2,2
?????#????? 2,3,2
???.?#????. 1,3
##?..???##??? 3,6
.??.#???#?? 2,2,3
.?????#?????##?? 3,1,1,4
???#?????##??? 2,4
????.#???#??#???.? 1,11
???.?.???? 1,1,2
#??###???#???.#? 1,8,1,2
.????.??## 1,1,2
??????????#??????# 1,5,2,1,2,1
.????????#?#??#.? 5,4,2,1
?????.???????#?.?? 4,4
??#?.??###..? 2,5
.?????.??. 1,1,1
??????.??. 1,1,1
.?#?.?#??##?##?? 2,2,6
##?.?#???? 2,3,2
?..?#.##???????#?? 1,1,4,4
??????????##?#? 1,5,1,4
???#?????.? 2,3
?#.?#????.???#??? 1,3,1,4
.?##???.??? 3,1,1
###.????.#????#?##?? 3,2,2,7
.?#??#????#? 3,1,2,2
.#???#?????#????? 5,1,1,3
??#??#?????.???????. 9,4
..????.?.??????.??? 1,1,1,1,3,2
??.????.??.. 1,1,1,1
##???#??????.##??# 8,1,3,1
?????#??.# 7,1
.??.#?..??? 1,2,1
??#?.#?????. 2,1,1,1
.??#.?###?????.#???# 1,1,4,4,5
.??.???#?.#???# 1,2,2,2,2
##???##?.??.?## 8,1,3
?##??#??#?. 2,5
???#.???#???????? 4,10
?.?#?#????? 1,2,1
?#??.??.?..??.? 3,1,1,1
.???#.#??. 1,1,1
?#?.??.????.. 2,1,1,1
???????#?.. 4,2
????.?.??????. 1,3
???#??#???? 6,2
????#??###.??#??. 1,1,1,4,2
??????????# 2,3,1
??#?.??????##??.? 2,3,5
????...????#?# 1,1,7
.?#???.????????.? 4,5
.#?#??.?.????...?.## 1,1,1,4,1,2
?????#?.?..#. 6,1
???..?????.?#?# 3,1,3,3
????#??????#??##???. 8,7,1
#??????##?##.???? 1,7,2,2
#?.#??#????.??. 1,2,1,1,2
?#????#??.?? 3,3,1
?#????????????#?#? 5,4,5
??????????. 2,3,2
???????##?#????#?? 1,1,1,6,2,1
??#?#?#??.??. 7,1,1
??.#???#??????#? 2,1,1,5,1
?.?#.????? 1,1,1
?##???#?#???????.? 8,2
.#?##??????. 4,2
#?.###????#?.?.? 2,5,2,1,1
...??????.??.?##?. 3,4
.#?.????????#? 1,1,1,4
?.?##.?#??###?#?##.? 3,12,1
??#.???#?#?#???#? 1,1,8,2
.??#.?.????????.?? 1,7
???????????. 1,1,1,1
.??????.??. 1,1,2
.##???.?##?.??#.?? 4,3,3
.#??.?..?#???? 2,1,3
????#????? 2,2,2
.#??????####??.. 1,8
??..??#???.# 2,3,1,1
?#????#??????.? 2,4,1,1
?#?.?.?.????????## 2,1,1,1,4
.??#?#?.?#?#?##?##?? 5,10
?#?.?.?????#.?#??? 1,1,1,1,2,2
.???##.?#???#??? 5,3,5
????????.???#?.?.?? 1,4,1,1,1,1
?#?????.?? 6,1
.#?.?????##??### 2,10
?#?????????.? 1,6
?..???????##?#?#?? 1,13,1
.????????? 1,2,1
???????#?.??? 1,6,1,1
?.##??...?. 4,1
??###????##?? 5,3
#??#.??#.???#?##?#?? 2,1,3,1,8
.????????#????.??? 2,1,5,3
???#??????##?????#?? 1,1,1,10
.??#????.???##?????? 1,1,10
###??.?????.?? 3,1,4,1
????.###????#? 1,4,2
..?????????. 1,7
???#.#.?##???? 4,1,3,1
#??#??.#?.?. 2,2,1,1
????#?????#???#? 9,2
.??.##?#?.???? 2,5,2
??#?#.#?##?????? 3,1,5,2
.??#?.?#?????..??#. 2,2,3,2
#?.?#??#?#?#.? 1,8,1
??.?#?.?.?#??.#? 2,2,1,3,1
#.#?????????.????? 1,2,4,1,1
????..??????#.?# 2,3,1,1
..#???#.??.?? 5,1,1
#?.???#??? 2,6
.##.?.#.??#???#?## 2,1,1,10
..????..#??.. 3,1
#??????#??#. 1,1,1,4
??##????..????.?? 3,1,4
????.####?. 2,5
??..#???#?##?? 1,10
???.#?????.? 1,1,1,1
??????.##? 2,3
#?#?###???#??? 1,7,1,1
.?.?#.????????.? 1,4
??##.??##..#?#?#??? 2,4,1,1,4
???###?.????? 4,1
?..?.#???#####? 1,1,1,7
?.###???.??#??#???? 3,1,1,8
?###???.???? 4,3
?.?.##.#???. 1,2,2,1
???.?????#??#??# 1,6,1,2
??????#??.???##?? 9,1,4
??.????#??? 1,3
???..?????? 2,1,1
????.?.##??????. 1,1,2,2,1
.?#??##???.??#???.? 7,4,1
#?????????#??#.?? 6,7,1
???..##???? 1,2,1
###?????.?????? 3,2,1,2,2
???????##?? 5,3
???#???.??#???? 1,1,1,4
??#..??.?#?###????? 1,1,6,4
?.??.??#?? 2,4
?.????#?.?? 2,1,1
????...???????.? 3,1,1
..##?????#??. 4,3
.??..##???? 1,2,1
??.??##?#????. 1,8,1
?.#.???.##..#????# 1,1,2,2,1,3
?????##???#...?? 9,1
??#?.?.??#. 2,1,1
??.??.#???#..?#????. 1,1,1,2,5
????.???#?????###? 1,1,4,4
???????#?#??.???. 2,8,3
?#?#.?.#.?.????????? 2,1,1,1,3,3
?????.##???##?#???? 1,13
????.??#?? 2,1,1
????#??..# 1,3,1
?#??#???????????? 8,1,1,1
????#.???.#???? 1,1,2,5
????????##?#??##??#? 1,2,13
?.??##?#?#??##? 1,12
????????????#?.?# 2,1,2,4,1
#?#????#?. 1,3,2
????#??.?.#?????#? 6,1,1,3
???#??#???#??????# 1,6,1,1,1,1
??.#???###?.#??????. 2,1,1,4,1,5
??.??????###??# 1,11
?.#?#?????.????.?## 7,3,3
.#.?#.??##?#?#?.?? 1,2,8,2
?#??###?.?# 1,5,2
..#??.??????#?#?? 2,9
??#?.?.???##?????#?? 4,1,9,1
???.???#???#?? 2,1,6,1
..???????? 2,3
??????..#.? 1,1,1
????????????## 1,1,4,3
????##???#.?##?#??# 6,1,4,1
#????.#.?#?##?.#? 2,1,1,4,2
#??????...#??#????? 3,2,6
?#?##?.?????.? 5,2,1
??##.?????#?. 3,2,2
???#?.??????##. 5,1,1,4
??#???#??#???##.#.? 14,1
???????..?#??? 5,1,5
??????#?#?.#?? 2,4,1
????#?????. 1,5,1
#.?..##????#.?#???# 1,1,3,3,5
??#?#???#????#.???.? 14,2
.????#?.?? 3,1
???#???????.?????? 1,3,4,1,1,1
???.???????.. 1,2,2
?????.??#.? 1,1,2
?#..?.?#?##????#?.. 1,11
#?.?##??????#.?. 2,2,5
.?#???##???.? 6,2
??#?#????#.???# 7,1,1,1
?.????#??????#?????# 1,3,2,3,1,3
???##?#???##..?#??.? 1,3,1,3,4,1
.?.?.#?#?#?##?##?.?? 1,10
.?????#??#???#?.. 2,5
???..????.?. 2,1,1
..##??????.?? 4,2
????#??.???#??????? 3,1,9
??????..??#???? 3,3,1
...#.#??????##?. 1,1,2,4
???#.??.?#??? 4,1,2,1
???.?#??.#??###? 1,2,6
???#?????????##?.? 1,2,1,6
???????????.???. 9,1,1
?.?###?##???. 1,3,3,1
.#??.?.????????. 1,1,3,1,2
.?.#???..??? 1,1,1,1
#?.??#.?.. 1,1,1
#.#?.???#??###???#.? 1,1,1,11
.???..?###???#?##?? 2,6,5
?.??#???#?##??.?. 4,5,1
??????????#????.?. 2,8,1
.#?....????????. 2,1
??????.?##?. 1,2,4
??????.?#?#??? 2,1,4,1
?.????#?#?????.? 1,7,1,1
#???#???..#.??#. 1,1,4,1,3
#???#?#?#.# 2,5,1
.????.#?????.# 1,1,6,1
??#?????.#???##??? 3,1,1,2,3,1
##???????#?##.??. 13,1
.??.#?#?????? 1,1,6
?????????##?? 1,2,5
??.??.?#.??#?#???#?? 2,1,1,3,6
??.??.#???.??.? 2,1,1,1,1
.??#?????? 2,3
????.??#?##?.?# 1,1,6,1
???#???#?#?? 1,3,1,1
#..?#????????.#??#?# 1,9,1,4
???#????#.?.???#? 3,2,1,4
???##??.??.?#?##.#? 5,5,2
??.?#??#.??.? 2,1
#.???#????.?#?.?? 1,3,3,3,1
.?????#?.??.?? 1,2,1,2
???.??##????? 7,1
???#????.?#??#????? 3,8
????#???.???##? 5,1,1,3
?????????????. 5,1,4
????.#??#?# 1,6
????...?.?#??.????? 1,1,1,4,4
???.??????#?????.#. 1,3,2,3,1
?##????#?#?#?????.? 4,6,1,1
..?#???....?##?##?? 3,7
?.?.?#?.?.?#???.?. 2,3
???#?????? 4,1
..?.??#??.?#??? 4,3
???..????#??.???#?. 2,5,1
?.#?.??.?? 1,1,1
????#?###.???#?#?#?? 7,8
????#?#????#?..???.? 4,7,2
???#?.?.?.?. 1,1
?.##.??#?. 1,2,2
?.?????????????? 4,4
.?#.?.??.????#??? 2,1,7
?.???.????. 1,1,1
?#??#???.?##???#??? 5,9
??#?????##..?# 4,3,2
#????????.?#??#.#.# 9,1,2,1,1
.????????#?? 1,2,2
???????.?? 1,2,1
???????.?##.# 2,1,3,1
???.?#?####??#??#?#? 2,7,7
?.?...??###?????? 1,5,1,1
?.???#?????#????? 10,3
??##?.??##????#????? 4,5,3
#?.???###????. 1,2,6
?#.?????.?. 1,4,1
?????####?.????##? 1,1,6,2,3
..?.??????#????###?? 1,16
???..?#??#?#?????? 1,9,1
?#??#??.?#???#?? 1,4,8
?????????.?##???.?? 1,1,3,3,1,1
?.?#??##??##????.?. 10,1
##.?.?#??. 2,1,4
#.?.#????????#???#?? 1,1,1,1,2,8
????##?#??? 1,4
??????##?? 2,2
?##???.#?#??? 5,3,1
??..????????? 1,2,2,1
????????????? 1,1,5
??..#???##?.?.?# 1,3,2,1,1
?#??#??##?????.. 4,2,1
?#??#??.?#??#??. 5,5
##??????#???? 10,1
#??#??????.?#?? 1,4,1,2,1
??#?#??.??.?.???.??? 7,1,1,1,1
?##?#????. 6,2
????????###???????? 2,1,11
??????#??????? 3,1,2
?.?#.?????????#???.? 1,1,1,8,1,1
#???#?.???#??#?????# 1,2,5,3,1
???.??#.????? 1,1,2,1
.????..#?##??#?#. 2,9
#?#??????? 5,1
##???????#??.?# 3,8,1
????#???#???? 1,2,1,3
?.#.?????###?#???? 1,10
?????...#??.#??.. 4,2,1
..??.??????.? 1,2
.?.?.?.??#.?. 1,1
..??#.??????? 2,4
#??#???#???.?#??.?? 6,1,2,1,1,1
..???????.??#??.?? 5,5
???.?#??..?????. 1,4
?.???#?#???????#. 5,1,1
????##???# 1,5,1
#???##???????#? 2,4,2,3
?#?##??????? 6,1,2
??#??###?????# 11,1
?#??#?????..#??###?? 8,7
#.?????.?# 1,4,1
#?##?????????#????? 5,10,1
#???#??#?.??.?#??#? 9,1,1,1
?###?????#? 5,1
???.????..#?###??. 1,2,7
??.?.?.??#?#?. 2,1,5
??#??##?.???#?#???. 4,3,1,1,2,1
?????#??????##.#.#?? 2,9,1,1
#?.?.#?.??????? 1,1,1,1,2
.?#??????????.??.? 6,2,1,1
?.??..?????#?.? 1,6
.?????.???#?????# 1,2,3,1,2
.#??#??#?#??#..?##? 1,2,1,2,1,3
?.?###?????#?###??. 5,8
??#?#?.???.#?##???? 1,1,1,1,5,2
????.???#???????.??# 1,1,5,2,1,1
??#.????##???#?..#. 3,4,1,1,1
????#?..?#.????? 1,1,2,2,1
??#?####????####???? 8,8
???.#?#??#.?? 1,3,2
???#???##?.#.??????? 1,7,1,1,1,1
?????#?.#?.??##.??.? 5,2,1,2,1
?#??????#??????## 9,2
?#??#?#??#?#???? 1,1,10
???????#?#.?# 1,5,1,2
??#?????????. 1,1,8
??????.??? 4,1
?????#?.??##?##.# 2,3,6,1
?#?#???????#??# 6,4,1
??##?????????#??#??? 1,15,1
??#?#?###????#..?? 8,2,2
??#?#?#??.????????. 6,1,1,1,1,1
???.?.??????#?.??? 2,1,8,1
????#???.?.??? 6,2
?#?.????.?????###### 2,4,1,1,7
#????????#?#??#?? 2,2,9
#????##???.?#.. 8,2
??#?????#????#??#? 3,2,10
???#??#???? 4,2,2
..?.???#.#??#?? 1,3,1,4
???#?.????#? 3,6
.??????##?#?.? 1,2,4,1
??.???#?.?#?##? 1,5,5
??##?#??????##??##.? 4,1,9
.#??#??.?##.? 4,3
.??#??#???#????? 3,7
???????#??#?##??. 5,8
.????????????#?????? 2,11
.##????#??#??.????#? 11,4
?##??..?.? 3,1
???#.?.?#?? 1,1,2
..#??????.??#??? 7,5
??.#?#.????????#?# 1,1,1,2,7
.#????.????#???.? 5,7
#??#???.??? 4,2
##???.?.#.?.#??.# 4,1,1,1,1
?##?.???#?? 2,2
?.??.?#???????###?? 1,1,6
???.?#???.?? 2,1,1,1
.?..?.##???#???# 1,6,2
???#???.#..? 7,1,1
.?.?..#???????? 1,8
??.#?##??????? 1,8,1
?.?#??#?#.??#.#? 1,2,3,3,1
????##?????#?.. 1,2,1,1
???#.??.?????? 1,1,2,2
??###?#?#.?..?.? 9,1,1
..?????#?##? 3,5
??#????.??? 6,2
????##?.??????? 6,2,1,1
?#?#??#??.??? 8,2
?#?????#??. 3,3
??????#?## 2,5
????.#???? 2,1,1
.#?#??..???. 5,3
?????#?##???? 1,2,5
??.#.??.#..#.????? 1,1,1,1,1,3
?????????.? 6,1
?#?????#.??.# 8,1,1
?.?#?#..???? 4,2
???#.????#? 4,5
#??????.???? 1,1,1,3
??#??##????.????? 7,4
#..???????????.??? 1,5,1,1,1
.??#?.??????? 3,6
.???..?#?##? 2,5
?#???#??????#?????? 4,2,1,3,3
??.???????##?# 1,7
??.??.?#.? 2,2
?????????.#?? 2,1,2,3
#.????????#?????.? 1,1,5,1,1
???????.??#? 3,1,2
?.???#??????#.?. 5,1,1,1
#?..?##?????#?#????# 2,5,6,2
?????#.??.?###.#??# 4,1,3,4
?.????.?.? 1,1
???##???.?.?????? 3,1,1
##?.#??????.??? 3,3,1,1
.?????#?#?#.# 1,7,1
#?.???#?????. 1,4,3
?#????.#?#???. 3,1,6
?#????????#????? 4,7
?#??..??.?#??#??#.? 4,2,2,5,1
??.???????.??? 3,1,1,1
???.????.?.??#???.? 1,5
?#???.????..?????.?? 3,1,3,4,1
???#??.#???##???? 1,2,1,8
.#??#?#???#??? 7,2
????????.??#.?? 1,1,1,3,1
??##???#??#. 3,4
???#?.?.?. 1,1,1
??.???????.? 2,4
?#???#?#????. 6,5
?.??##?.?#?????? 5,8
##?????..?.? 3,1,1
..??#??.#???##???? 4,7,1
???.?.##?.. 2,2
?.??????.?.?#??.??#? 4,1,4
.??#?###?#??#????.?. 14,1
????.???.?##??.???# 2,1,5,1,1
.?????.???????#.??#? 4,1,1,4,1,2
???...?????? 2,1,2
??##?#.??????#.? 1,2,1,1,3
?.?##???#? 4,1
.#????.?#?? 3,3
??#??#?????#?.#?#? 7,2,4
???#???#?????#???# 14,2
.?..????????#????##? 1,1,13
????#?##.?????.??#? 8,1,2
?#???#?#???? 1,1,1,1
?#...??..? 1,1
#.???#??.? 1,3
???????????????. 2,4
.??#.???.#?#?# 3,5
..#???????.????#??? 1,2,1,5,1
?#?????..??#?? 5,3
.#?##??.??#??? 4,1,1,1
???.??.????# 1,1,1,4
????#?#??#?? 1,2,1,1
?#?#?.??##??#??. 3,6,1
???##???????#???.#? 1,4,1,4,1,1
#??.#..#?#?? 2,1,1,1
?..??#????. 2,1
????????.?. 1,1
????????????? 2,1,1,1
??#..??#???#?##??# 1,1,1,11
???????????? 1,3,3
..???.????#?#??#?? 1,5,3
?????????.##??? 3,1,1,4
???????#?#?#???. 1,9,1
#?????#?#?.??#????. 5,4,1,1,1,1
????.#.?.??#?.??.. 1,2
??.#??.?..????###?# 2,1,1,1,1,6
????#.?.????#??. 1,2,1,4
?????.??#????.???? 3,3,1,1
?..#?#??#?#?? 1,4,4
????.?#??? 1,3
?.#?#?######?. 1,10
#???#???#.?.?#???? 3,2,2,1,5
#????.???????.#??? 2,1,4,1,1
???###??????? 6,2,1
????.#??#? 1,1,1
???#?#?#?#????.#???? 14,1,2
..?????.??? 4,2
?????.??#?#????? 3,7
?.##??#??##?#????? 3,5,2,3
..??#???.?#? 1,2,2
?#??#????##??#?. 2,4,3,2
##???#?.?#???.?? 3,1,1,1,1
??#????#??.#?#??#.#. 7,3,1,1
????#?#.??.#? 4,1
???#?.???? 2,2
#?????????????.? 1,9,1,1
????#?#?#.??? 8,2
.?????????#?? 1,3,2
?.???###?.??#?#?##?? 1,6,8,1
???.????#?.#???##. 2,1,2,1,3
??##???#?? 2,1,1
..?.??.?##?# 1,5
??????#??.?? 8,1
???#?#?.?#?.?#?? 2,4,1,2,1
?.#.?????#?##?#???.# 1,3,6,1,1
??.????????? 1,2
.????????? 2,3
?????#?#?? 1,4
??????#??#?.????? 1,4,1
?#????#.??##? 1,3,2
???###?#???#?#??#?? 2,11,2
??#???.?????#???? 4,5
??.#????#?..#? 1,1,5,1
???#?????.#.??.?? 5,1,1,1,1
??#????#?.#??. 4,2,1
?.?????#????##????? 1,1,2,1,7,1
?#?.#?.???.#?## 1,1,1,4
???#???.?#????##? 1,4,4,3
??????.?##??##????. 1,1,1,6,1
..?????.##??? 3,2,1
?#?#.?????#?# 3,2,4
?.?##??#???.? 1,7,1
????#.???#??#?## 4,1,1,2,2
?#??###?.??.?#? 7,1,1
???????.#?#?#?????? 4,6,1,1
??#????.#??? 1,1,1,1
.#?#??.?.? 1,1,1
##?#??.#???#? 4,1,2
..????#???#. 2,1,2
?????????.? 1,4
?#####??##?.????#. 11,1,1
####?##.?.?. 7,1
#.?#??.???.###? 1,3,3,4
.#????#???? 1,3
??????#????.??? 9,1,1
????#?????#? 3,1,2
?????##?????#?.? 7,2,1,1
????.##??????#??##?# 1,3,2,6,1
?#????????????. 7,4
???#.?.?#?????##?? 2,9
???..??.?..#?# 1,2,1,3
?#..???.?.#?.????? 1,3,1,1,1,1
??.??#????.?##.? 2,3,2,3
???#??#????? 1,1,2,1
????##??.?????? 2,5,1,2
#?????#.#?#??#??# 1,1,1,7,1
???#??#??.??. 1,4,1
??????#.?#????#? 5,2,3
?.??##??????##??#?# 15,1
??.???????##??#??? 2,11,2
???#??#??..#???.? 5,2
?.#????????#...#? 3,5,1
???#?????#??.?#?##?? 1,1,2,3,5,1
#?#.#?????. 3,3,1
?????.##.??#???? 1,1,2,3,1
??.?#?#????##??????. 1,3,5,1,1
.?????##??.#??. 7,3
#.?????????#?#???. 1,3,6,1
?????#.?.??#??#.? 2,1,5
??#?..?.???? 2,3
?.#.?.?????##?.#?? 1,1,1,1,2,2
.??????.?. 2,3,1
?.??....???? 1,2
?###..??.#????#??#? 4,2,1,1,2,1
?#?.?????#??.#?.?? 1,8,2,1
.????..?#???????? 2,10
.#?????##?? 4,3,1
????#?#?????#??.? 8,2,1
?#????????##??? 3,6
?.??????.???????#.? 1,3,1,2,1,1
???????????????#?..? 2,10,1
#??##??.????#? 2,4,1,3
#?????.??. 3,1
?????.?#??? 1,2
.#??#??#?#??##.?.?# 13,2
?#???#.??? 1,2,3
?.?####?#??.?.?#? 7,1
.??.?.???? 2,1,1
#.??#???.??????????? 1,4,2,2,1,3
?.?.##??.?. 1,3,1
????#????????? 6,5
.??.????##.? 1,5
???#?...#?#??? 3,4
????.?????#?? 1,6
??..?..???#?? 1,1,1,2
?#??#?.?###.# 5,3,1
.?##?#?.#??#???? 6,1,6
.##???#????#.???? 8,2,1,1
.????#.??#..??.##?. 5,3,1,2
?????.??#? 2,3
???####??????# 10,1
.?#??..#.?? 3,1,1
?#??..#???.?? 3,4
#?..???#??. 2,1,2
???????#???###????#. 1,13
????##???#...#??#.? 2,2,1,1,2,1
???#???..? 3,1,1
???.?.???? 1,4
?###????????.#? 8,1
.???#????.?.???? 4,3,4
?#????.???. 1,1,3
??????..?..?#??? 4,1,1,1,1
?????#.???#?. 4,2
?#?#????..????? 1,1,2,1,1
?#?.##??#?. 2,3,1
????.?#?#? 2,2,1
??###?##???#? 5,2,2
?#??#####??#.?.#?#? 2,8,4
??#?????????#? 3,2,3
#???.?#??? 2,1,1
??###?##???#???.??.? 8,3
??...#?#?.#??? 1,3,1,1
####????????... 9,1
.?#?...??#???#??.? 2,6
?#???????#???#???.? 1,1,1,4,5,1
?###???#?.#?.?.?#? 3,1,2,3
?????.?????.?#??? 4,4,3
??#?.?#???? 1,4
#.??#?##????? 1,5,1
#.???????#???#? 1,1,1,2,2
???.?#???????#???##? 2,6,1,6
?#.??#..???#?. 1,1,5
?.?##?.#??..????#? 1,4,3,5
.?#?#?..??? 4,1
?????#??#????????? 2,3,3,3
??.??????#?##?#??#?? 2,10,1
?#?##???????.??. 7,1,1
?#????#?????##?????? 7,1,5,3
???#?#.??? 4,1
?###??##??.?#?.??#? 10,1,2
.?#?#?.#????..????? 4,1,3,4
#???????.???#?????.? 8,1,3,1,1
?.#??#.?#??#?#??#? 1,1,7,2
#?#?????#???.?.. 6,3,1
?.#?#????????? 1,6,1,1
.#????#?..? 2,3
??#????.???#.?????? 6,1,1,1,1,1
??..?????.????????? 5,3,1,2
????????#?? 1,4
?.?#?#.###?.#??.?? 1,4,4,1,1
????.?????? 1,4
.??#?#????# 7,1
.#.????.?#? 1,1,1
###???????????.#.#? 11,1,1,2
.#?#???????#?? 4,2,3
###??#?.###?#??. 4,1,5
##??#..????? 3,1,5
?.?.????#?.??????? 1,1,3,6
.#?#???.??##.????.?. 5,4,1
.?#????#?#?.?#.?? 10,1,1
???###?##?????#??? 12,1
#.#????.?#????#?.# 1,5,2,4,1
.?.?#???#??#?.#.? 1,2,2,1,1
?#.?.????#?. 1,4
..??##?.?????? 5,1,1
???.?##??????#?##?? 1,3,9
??????#??? 3,3
???#????????????.??. 7,1
??.??#?.#??#?.? 3,1,3,1
?.???????#???#?.#?. 1,12,2
#?#?#??.?.?????? 3,2,1,6
????#.??##?? 3,1,3,1"
        .to_string()
}
